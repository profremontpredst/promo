
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ü–∏—Ü—Ü–∞ –ø–æ –∫–∞–π—Ñ—É</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #fff7f0;
      color: #333;
    }
    header {
      background-color: #ff5c33;
      padding: 20px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    header h1 {
      margin: 0;
      color: white;
      font-size: 28px;
    }
    nav a {
      color: white;
      text-decoration: none;
      margin-left: 30px;
      font-weight: bold;
      font-size: 16px;
    }
    .hero {
      background: url('https://cdn.pixabay.com/photo/2017/12/09/08/18/pizza-3007395_1280.jpg') center/cover no-repeat;
      height: 500px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      text-shadow: 0 2px 4px rgba(0,0,0,0.5);
    }
    .hero h2 {
      font-size: 48px;
      max-width: 80%;
      text-align: center;
    }
    .modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0,0,0,0.4);
      display: none;
      z-index: 9999;
      width: 90%;
      max-width: 800px;
      text-align: center;
    }
    .modal.active {
      display: block;
    }
    .catalog-grid {
      display: flex;
      gap: 20px;
      justify-content: center;
      margin-top: 20px;
    }
    .catalog-item {
      border: 1px solid #ccc;
      border-radius: 8px;
      overflow: hidden;
      background: #fafafa;
      text-align: center;
      padding-bottom: 10px;
    }
    .catalog-item img {
      width: 240px;
      height: 180px;
      object-fit: contain;
    }
    .catalog-item h4 {
      margin: 10px 0 4px;
    }
    .catalog-item .price {
      color: #d62828;
      font-weight: bold;
    }
    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.5);
      display: none;
      z-index: 9998;
    }
    .button {
      background: #ff5c33;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
      margin-top: 20px;
    }
    .combo-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 20px;
    }
    .combo-content img {
      max-width: 250px;
      border-radius: 12px;
    }
    .loading {
      font-size: 20px;
    }
  </style>
</head>
<body onclick="nextStep()">
  <header>
    <h1>–ü–∏—Ü—Ü–∞ –ø–æ –∫–∞–π—Ñ—É</h1>
    <nav>
      <a href="#menu">–ú–µ–Ω—é</a>
      <a href="#about">–û –Ω–∞—Å</a>
      <a href="#contact">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
    </nav>
  </header>

  <section class="hero">
    <h2>–ì–æ—Ä—è—á–∞—è –ø–∏—Ü—Ü–∞ –ø—Ä—è–º–æ –∫ —Ç–≤–æ–µ–π –¥–≤–µ—Ä–∏ üçï</h2>
  </section>

  <div class="overlay" id="overlay" onclick="closeModals()"></div>

     <div class="modal" id="catalogModal" style="padding:0; background:transparent; box-shadow:none; max-width:95%; max-height:90vh; overflow:auto;">
    <img 
      src="https://i.imgur.com/VuEyLEV.jpeg" 
      alt="–ö–∞—Ç–∞–ª–æ–≥" 
      style="display:block; width:100%; height:auto; margin:0 auto;"
    >
  </div>

  <div class="modal" id="comboModal" style="padding:10px; background:white; border-radius:12px; box-shadow:0 0 20px rgba(0,0,0,0.4); max-width:600px; max-height:80vh; overflow:hidden; text-align:center;">
    <img 
      src="https://i.imgur.com/wjcGFg5.jpeg" 
      alt="–ö–æ–º–±–æ" 
      style="display:block; max-width:100%; height:auto; margin:0 auto; border-radius:8px;"
    >
  </div>

  <div class="modal" id="confirmModal">
    <h3>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –æ–ø–ª–∞—Ç—É</h3>
    <button class="button" onclick="nextStep(); event.stopPropagation();">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
  </div>

  <div class="modal" id="loadingModal">
    <h3 class="loading">–û–ø–ª–∞—Ç–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è...</h3>
  </div>

  <div class="modal" id="thanksModal" style="background: transparent; box-shadow: none; padding: 0;">
    <img
      class="thanks-gif"
      src="https://i.ibb.co/nsBbjDbJ/7322397e-5f75-4860-b295-ba68da91a108-1-2.png"
      alt="—Å–ø–∞—Å–∏–±–æ"
      style="display: block; max-width: 100%; background: transparent;"
      referrerpolicy="no-referrer"
    >
  </div> 

  <!-- ======= REPLACE FROM HERE TO </body> ======= -->
<script>
  // –î–µ–º–æ-–∫–ª–∏–∫–∏ –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ (–æ—Å—Ç–∞–≤–ª—è–µ–º)
  let step = 0;
  function nextStep() {
    document.querySelectorAll('.modal').forEach(m => m.classList.remove("active"));
    document.getElementById("overlay").style.display = "block";
    step++;
    if (step === 1) {
      document.getElementById("catalogModal").classList.add("active");
    } else if (step === 2) {
      document.getElementById("comboModal").classList.add("active");
    } else if (step === 3) {
      document.getElementById("confirmModal").classList.add("active");
    } else if (step === 4) {
      document.getElementById("loadingModal").classList.add("active");
      setTimeout(() => {
        document.querySelectorAll('.modal').forEach(m => m.classList.remove("active"));
        document.getElementById("thanksModal").classList.add("active");
      }, 3000);
    }
  }
  function closeModals() {
    document.querySelectorAll('.modal').forEach(m => m.classList.remove("active"));
    document.getElementById("overlay").style.display = "none";
    step = 0;
  }
</script>

<!-- –í–∏–¥–∂–µ—Ç: –∫–Ω–æ–ø–∫–∞ + iframe -->
<style>
  .ai-float-button{
    position:fixed;bottom:20px;right:20px;width:70px;height:70px;background:transparent;border:none;border-radius:50%;
    cursor:pointer;z-index:100001;padding:0;box-shadow:0 0 10px rgba(0,0,0,.3)
  }
  .ai-float-button img{width:100%;height:100%;object-fit:cover;border-radius:50%}
  #ai-chat-frame{
    position:fixed;bottom:20px;right:100px;width:340px;height:520px;border:none;border-radius:16px;
    box-shadow:0 0 20px rgba(0,0,0,.4);z-index:100000;display:none;background:transparent
  }
  @media (max-width:768px){
    #ai-chat-frame{bottom:90px;right:20px;width:calc(100vw - 40px);height:70vh}
  }
</style>
<script>
  (function(){
    // –ö–Ω–æ–ø–∫–∞
    const btn=document.createElement('button');
    btn.className='ai-float-button'; btn.title='–û—Ç–∫—Ä—ã—Ç—å –ê–Ω–Ω—É';
    const img=document.createElement('img');
    img.src='https://i.postimg.cc/mgP268Zt/96f08734-0442-48ea-bd9e-e3e25cb92060-1.png';
    img.alt='AI'; btn.appendChild(img);

    // Iframe
    const iframe=document.createElement('iframe');
    iframe.id='ai-chat-frame';
   iframe.src='https://gpt-widget-4f6q.onrender.com'; // –µ—Å–ª–∏ –¥—Ä—É–≥–æ–π —É—Ä–ª ‚Äî –∑–∞–º–µ–Ω–∏
    iframe.allow = 'microphone; autoplay';

    btn.onclick=()=>{ iframe.style.display = (iframe.style.display==='block') ? 'none' : 'block'; };

    document.body.appendChild(btn);
    document.body.appendChild(iframe);

    // –ê–≤—Ç–æ-–æ—Ç–∫—Ä—ã—Ç–∏–µ –æ—Ç –≤–∏–¥–∂–µ—Ç–∞
    window.addEventListener('message',e=>{
      if(e.data==='open-widget'){ iframe.style.display='block'; }
    });

    // ===== –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —Å—Ü–µ–Ω (—Ñ–∏–∫—Å –æ—Ç–≤–µ—Ç–∞ –≤ iframe) =====
    let widgetWin=null;
    const getWidgetWin=()=> widgetWin || iframe.contentWindow || null;

    function hideAll(){
      document.querySelectorAll('.modal').forEach(m=>m.classList.remove('active'));
      const ov=document.getElementById('overlay'); if(ov) ov.style.display='none';
    }
    function show(id){
      hideAll();
      const ov=document.getElementById('overlay'); if(ov) ov.style.display='block';
      const el=document.getElementById(id); if(el) el.classList.add('active');
    }

    let busy=false;
    async function runScene(scene){
      if(busy) return; busy=true;
      if(scene==='showCatalog') show('catalogModal');
      if(scene==='showCombo')   show('comboModal');
      if(scene==='confirm')     show('confirmModal');
      if(scene==='loading')     show('loadingModal');
      if(scene==='thanks')      show('thanksModal');
      if(scene==='reset')       hideAll();

      requestAnimationFrame(()=>{ setTimeout(()=>{
        const w=getWidgetWin(); if(w) w.postMessage({type:'pizza:uiReady'}, '*'); // ‚Üê –∫–ª—é—á–µ–≤–æ–π —Ñ–∏–∫—Å
        busy=false;
      },180);});
    }

    // –ü—Ä–∏—ë–º –∫–æ–º–∞–Ω–¥ –æ—Ç –≤–∏–¥–∂–µ—Ç–∞
    window.addEventListener('message',e=>{
      const t=e.data;
      if(!t || typeof t!=='object') return;
      if(t.type==='pizza:cmd' && t.scene){
        widgetWin = e.source || iframe.contentWindow;
        runScene(t.scene);
      }
    });
  })();
</script>
<!-- ======= /REPLACE BLOCK ======= -->
</body>
</html>
