
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ü–∏—Ü—Ü–∞ –ø–æ –∫–∞–π—Ñ—É</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #fff7f0;
      color: #333;
    }
    header {
      background-color: #ff5c33;
      padding: 20px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    header h1 {
      margin: 0;
      color: white;
      font-size: 28px;
    }
    nav a {
      color: white;
      text-decoration: none;
      margin-left: 30px;
      font-weight: bold;
      font-size: 16px;
    }
    .hero {
      background: url('https://cdn.pixabay.com/photo/2017/12/09/08/18/pizza-3007395_1280.jpg') center/cover no-repeat;
      height: 500px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      text-shadow: 0 2px 4px rgba(0,0,0,0.5);
    }
    .hero h2 {
      font-size: 48px;
      max-width: 80%;
      text-align: center;
    }
    .modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0,0,0,0.4);
      display: none;
      z-index: 9999;
      width: 90%;
      max-width: 800px;
      text-align: center;
    }
    .modal.active {
      display: block;
    }
    .catalog-grid {
      display: flex;
      gap: 20px;
      justify-content: center;
      margin-top: 20px;
    }
    .catalog-item {
      border: 1px solid #ccc;
      border-radius: 8px;
      overflow: hidden;
      background: #fafafa;
      text-align: center;
      padding-bottom: 10px;
    }
    .catalog-item img {
      width: 240px;
      height: 180px;
      object-fit: contain;
    }
    .catalog-item h4 {
      margin: 10px 0 4px;
    }
    .catalog-item .price {
      color: #d62828;
      font-weight: bold;
    }
    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.5);
      display: none;
      z-index: 9998;
    }
    .button {
      background: #ff5c33;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
      margin-top: 20px;
    }
    .combo-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 20px;
    }
    .combo-content img {
      max-width: 250px;
      border-radius: 12px;
    }
    .loading {
      font-size: 20px;
    }
  </style>
</head>
<body onclick="nextStep()">
  <header>
    <h1>–ü–∏—Ü—Ü–∞ –ø–æ –∫–∞–π—Ñ—É</h1>
    <nav>
      <a href="#menu">–ú–µ–Ω—é</a>
      <a href="#about">–û –Ω–∞—Å</a>
      <a href="#contact">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
    </nav>
  </header>

  <section class="hero">
    <h2>–ì–æ—Ä—è—á–∞—è –ø–∏—Ü—Ü–∞ –ø—Ä—è–º–æ –∫ —Ç–≤–æ–µ–π –¥–≤–µ—Ä–∏ üçï</h2>
  </section>

  <div class="overlay" id="overlay" onclick="closeModals()"></div>

  <div class="modal" id="catalogModal">
    <h3>–ö–∞—Ç–∞–ª–æ–≥</h3>
    <div class="catalog-grid">
      <div class="catalog-item">
        <img src="https://i.ibb.co/mr9SDRxD/2d5e4c63-7964-4578-925a-c774e78020d7.png" alt="–ü–∏—Ü—Ü–∞">
        <h4>–ü–∏—Ü—Ü–∞ 33—Å–º</h4>
        <div class="price">850 ‚ÇΩ</div>
      </div>
      <div class="catalog-item">
        <img src="https://i.ibb.co/spcFRTyK/dbbd4099-3e02-44cf-b46f-6ebb7f052682.png" alt="–ö–∞—Ä—Ç–æ—à–∫–∞">
        <h4>–ö–∞—Ä—Ç–æ—à–∫–∞ –±–æ–ª—å—à–∞—è</h4>
        <div class="price">300 ‚ÇΩ</div>
      </div>
      <div class="catalog-item">
        <img src="https://i.ibb.co/C3XDzbXn/3f125871-9eba-40ef-a9a5-5482908c7093.png" alt="–ö–æ–ª–∞">
        <h4>–ö–æ–ª–∞ 1–ª</h4>
        <div class="price">350 ‚ÇΩ</div>
      </div>
    </div>
  </div>

  <div class="modal" id="comboModal">
    <h3>üî• –ö–æ–º–±–æ –∑–∞–∫–∞–∑</h3>
    <div class="combo-content">
      <ul style="text-align: left;">
        <li>üçï –ü–∏—Ü—Ü–∞ –ü–µ–ø–ø–µ—Ä–æ–Ω–∏ ‚Äî –ë–æ–ª—å—à–∞—è</li>
        <li>üçü –ö–∞—Ä—Ç–æ—à–∫–∞ –§—Ä–∏ ‚Äî –ë–æ–ª—å—à–∞—è</li>
        <li>ü•§ –ö–æ–ª–∞ ‚Äî –ë–æ–ª—å—à–∞—è</li>
        <li>üéÅ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–æ–Ω—á–∏–∫ + 30% –∫—É–ø–æ–Ω—á–∏–∫</li>
      </ul>
      <img src="https://i.ibb.co/Q7Khbrn7/78d96ef5-65af-4aec-a0f3-a93257d5c566.png" alt="–ö–æ–º–±–æ">
    </div>
    <p><s>1500 ‚ÇΩ</s></p>
    <p style="font-size: 24px; color: #d62828; font-weight: bold;">1050 ‚ÇΩ —Å —É—á—ë—Ç–æ–º —Å–∫–∏–¥–∫–∏</p>
    <button class="button" onclick="nextStep(); event.stopPropagation();">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
  </div>

  <div class="modal" id="confirmModal">
    <h3>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –æ–ø–ª–∞—Ç—É</h3>
    <button class="button" onclick="nextStep(); event.stopPropagation();">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
  </div>

  <div class="modal" id="loadingModal">
    <h3 class="loading">–û–ø–ª–∞—Ç–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è...</h3>
  </div>

  <div class="modal" id="thanksModal" style="background: transparent; box-shadow: none; padding: 0;">
    <img
      class="thanks-gif"
      src="https://i.ibb.co/nsBbjDbJ/7322397e-5f75-4860-b295-ba68da91a108-1-2.png"
      alt="—Å–ø–∞—Å–∏–±–æ"
      style="display: block; max-width: 100%; background: transparent;"
      referrerpolicy="no-referrer"
    >
  </div> 

  <script>
    let step = 0;
    function nextStep() {
      document.querySelectorAll('.modal').forEach(m => m.classList.remove("active"));
      document.getElementById("overlay").style.display = "block";
      step++;
      if (step === 1) {
        document.getElementById("catalogModal").classList.add("active");
      } else if (step === 2) {
        document.getElementById("comboModal").classList.add("active");
      } else if (step === 3) {
        document.getElementById("confirmModal").classList.add("active");
      } else if (step === 4) {
        document.getElementById("loadingModal").classList.add("active");
        setTimeout(() => {
          document.querySelectorAll('.modal').forEach(m => m.classList.remove("active"));
          document.getElementById("thanksModal").classList.add("active");
        }, 3000);
      }
    }

    function closeModals() {
      document.querySelectorAll('.modal').forEach(m => m.classList.remove("active"));
      document.getElementById("overlay").style.display = "none";
      step = 0;
    }
  </script>
  <script>
  // === –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —Å—Ü–µ–Ω –æ—Ç –≤–∏–¥–∂–µ—Ç–∞ ===
  const modals = ["catalogModal","comboModal","confirmModal","loadingModal","thanksModal"];
  let busy = false;

  function hideAll() {
    document.querySelectorAll('.modal').forEach(m => m.classList.remove("active"));
    document.getElementById("overlay").style.display = "none";
  }
  function show(id) {
    hideAll();
    document.getElementById("overlay").style.display = "block";
    document.getElementById(id).classList.add("active");
  }

  async function runScene(scene){
    if (busy) return;
    busy = true;
    // –∫–∞—Ä—Ç–∞ —Å—Ü–µ–Ω
    if (scene==="showCatalog") show("catalogModal");
    if (scene==="showCombo")    show("comboModal");
    if (scene==="confirm")      show("confirmModal");
    if (scene==="loading")      show("loadingModal");
    if (scene==="thanks")       show("thanksModal");
    if (scene==="reset")        hideAll();

    // –¥–∞–µ–º –≤–µ—Ä—Å—Ç–∫–µ —É—Å–ø–æ–∫–æ–∏—Ç—å—Å—è –∏ —Å–æ–æ–±—â–∞–µ–º –≤–∏–¥–∂–µ—Ç—É, —á—Ç–æ UI –≥–æ—Ç–æ–≤
    requestAnimationFrame(() => {
      setTimeout(() => {
        window.postMessage({type:"pizza:uiReady"}, "*");
        busy = false;
      }, 180); // –º—è–≥–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞, —á—Ç–æ–±—ã —Ä–µ—á—å –Ω–µ —É—à–ª–∞ –≤–ø–µ—Ä–µ–¥
    });
  }

  // –ü—Ä–∏–µ–º –∫–æ–º–∞–Ω–¥ –∏–∑ –≤–∏–¥–∂–µ—Ç–∞
  window.addEventListener("message",(e)=>{
    const t = e.data;
    if (!t || typeof t!=="object") return;
    // –û–∂–∏–¥–∞–µ–º {type:"pizza:cmd", scene:"showCatalog"}
    if (t.type==="pizza:cmd" && t.scene){
      runScene(t.scene);
    }
  });

  // –µ—Å–ª–∏ –∫–ª–∏–∫–∞–µ–º –º—ã—à–∫–æ–π ‚Äî –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–≤–æ—é –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—É—é –º–µ—Ö–∞–Ω–∏–∫—É
  // (–Ω–∏—á–µ–≥–æ –Ω–µ –ª–æ–º–∞—é)
<style>
  .ai-float-button {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 70px;
    height: 70px;
    background-color: transparent;
    border: none;
    border-radius: 50%;
    cursor: pointer;
    z-index: 99999;
    padding: 0;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
  }

  .ai-float-button img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 50%;
  }

  #ai-chat-frame {
    position: fixed;
    bottom: 20px;
    right: 100px;
    width: 340px;
    height: 520px;
    border: none;
    border-radius: 16px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.4);
    z-index: 99998;
    display: none;
  }

  @media (max-width: 768px) {
    #ai-chat-frame {
      bottom: 100px;
      right: 20px;
    }
  }
</style>

<script>
  window.onload = function () {
    const button = document.createElement('button');
    button.className = 'ai-float-button';
    button.title = '–û—Ç–∫—Ä—ã—Ç—å AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞';

    const img = document.createElement('img');
    img.src = 'https://i.postimg.cc/mgP268Zt/96f08734-0442-48ea-bd9e-e3e25cb92060-1.png';
    img.alt = 'AI';
    button.appendChild(img);

    const iframe = document.createElement('iframe');
    iframe.id = 'ai-chat-frame';
    iframe.src = 'https://gpt-widget.onrender.com';
    iframe.allow = 'microphone';

    button.onclick = function () {
      iframe.style.display = (iframe.style.display === 'block') ? 'none' : 'block';
    };

    document.body.appendChild(button);
    document.body.appendChild(iframe);

    window.addEventListener("message", (event) => {
      if (event.data === "open-widget") {
        iframe.style.display = 'block';
      }
    });
  };
</script>

<!-- –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —Å—Ü–µ–Ω —Å —Ñ–∏–∫—Å–∞–º–∏ -->
<script>
  let widgetWin = null;

  function getWidgetWin() {
    try {
      return widgetWin || document.getElementById('ai-chat-frame')?.contentWindow || null;
    } catch { return null; }
  }

  function hideAll() {
    document.querySelectorAll('.modal').forEach(m => m.classList.remove("active"));
    const ov = document.getElementById("overlay");
    if (ov) ov.style.display = "none";
  }
  function show(id) {
    hideAll();
    const ov = document.getElementById("overlay");
    if (ov) ov.style.display = "block";
    document.getElementById(id)?.classList.add("active");
  }

  let busy = false;
  async function runScene(scene){
    if (busy) return;
    busy = true;

    if (scene==="showCatalog") show("catalogModal");
    if (scene==="showCombo")    show("comboModal");
    if (scene==="confirm")      show("confirmModal");
    if (scene==="loading")      show("loadingModal");
    if (scene==="thanks")       show("thanksModal");
    if (scene==="reset")        hideAll();

    requestAnimationFrame(() => {
      setTimeout(() => {
        const w = getWidgetWin();
        if (w) w.postMessage({type:"pizza:uiReady"}, "*");
        busy = false;
      }, 180);
    });
  }

  window.addEventListener("message",(e)=>{
    const t = e.data;
    if (!t || typeof t!=="object") return;
    if (t.type==="pizza:cmd" && t.scene){
      widgetWin = e.source || getWidgetWin();
      runScene(t.scene);
    }
  });

  let step = 0;
  window.nextStep = function() {
    document.querySelectorAll('.modal').forEach(m => m.classList.remove("active"));
    const ov = document.getElementById("overlay");
    if (ov) ov.style.display = "block";
    step++;
    if (step === 1) show("catalogModal");
    else if (step === 2) show("comboModal");
    else if (step === 3) show("confirmModal");
    else if (step === 4) {
      show("loadingModal");
      setTimeout(() => { hideAll(); show("thanksModal"); }, 3000);
    }
  };
  window.closeModals = function() { hideAll(); step = 0; };
</script>
</body>
</html>
